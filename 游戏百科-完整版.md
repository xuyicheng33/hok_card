# 王者荣耀卡牌对战 - 游戏百科（联机模式完整版）

> **基于代码实现验证** | **模式：3v3 在线联机对战** | **服务器：121.199.78.133:3000**

---

## 第一章：游戏概述

### 1.1 基本信息
- **游戏类型：** 回合制卡牌对战
- **对战模式：** 3v3 在线联机（双人对战）
- **技术架构：** Godot 4.5 客户端 + Node.js WebSocket 服务器
- **核心特点：** 服务器权威计算（所有伤害、暴击、闪避判定均在服务器完成）

### 1.2 游戏流程
```
创建/加入房间 → 英雄选择(1-2-2-1) → 战斗阶段 → 胜负判定
```

### 1.3 胜利条件
消灭对方所有英雄（服务器权威判定，双方结果一致）

---

## 第二章：核心系统

### 2.1 回合系统
| 回合数 | 行动方 | 身份 |
|--------|--------|------|
| 奇数回合(1,3,5...) | 蓝方 | 房主(host) |
| 偶数回合(2,4,6...) | 红方 | 客户端(guest) |

### 2.2 行动点系统
- **每回合行动点：** 3次
- **消耗规则：** 普攻/技能消耗1次，购买/装备/合成不消耗
- **重置时机：** 新回合开始时，**仅重置当前行动方**

### 2.3 技能点系统
- **初始值：** 4点 | **上限：** 6点
- **获取方式：**
  1. 第3回合起，每回合+1点（给当前行动方）
  2. 孙尚香被动：70%概率+1点
  3. 大乔被动：濒死时+3点（溢出1点=150护盾）

### 2.4 金币系统
- **初始金币：** 10金币
- **回合收入：** 基础5 + 利息(当前×10%，上限5) = 最高10金币/回合
- **击杀奖励：** 20金币 | **阵亡补偿：** 30金币（阵亡≥2时，仅一次）
- **消耗：** 购买装备15金币，合成装备10金币

---

## 第三章：战斗机制

### 3.1 伤害公式
```
基础伤害 = 攻击力 × (200 / (护甲 + 200))
减伤率 = 护甲 / (护甲 + 200)
```

### 3.2 护甲减伤表
| 护甲 | 减伤率 | 伤害系数 |
|------|--------|----------|
| 0 | 0% | 100% |
| 150 | 42.9% | 57.1% |
| 200 | 50% | 50% |
| 325 | 61.9% | 38.1% |

### 3.3 伤害计算流程
1. 基础伤害（护甲减免）
2. 澜被动（目标<50%血时+30%）
3. 装备增伤（匕首+3%等）
4. 暴击判定 → 暴击伤害×暴击效果
5. 闪避判定（公孙离）
6. 护盾吸收 → 扣血

### 3.4 伤害类型
- **物理伤害：** 受护甲减免，先消耗护盾
- **真实伤害：** 无视护甲，**穿透护盾直接扣血**
  - 真伤技能：孙尚香、大乔、少司缘

---

## 第四章：英雄图鉴（8位）

### 瑶
| 属性 | 生命850 | 攻击280 | 护甲200 | 暴击0% | 暴击效果130% |
|------|---------|---------|---------|--------|--------------|

**技能-鹿灵守心（2点）：** 单友方获得护盾(170+瑶生命×10%)、暴击率+8%、护甲+25
**被动-山鬼白鹿✅：** 瑶受伤时，为血量最低友方加护盾(100+瑶生命×3%)

### 大乔
| 属性 | 生命800 | 攻击300 | 护甲150 | 暴击10% | 暴击效果130% |
|------|---------|---------|---------|---------|--------------|

**技能-沧海之曜（4点）：** AOE真伤=(已损生命+攻击力)/5，可暴击
**被动-宿命之海✅：** 致命伤害时→1血+3技能点，溢出转护盾(1点=150)，仅1次

### 公孙离
| 属性 | 生命600 | 攻击575 | 护甲150 | 暴击20% | 暴击效果130% | 闪避25% |
|------|---------|---------|---------|---------|--------------|---------|

**技能-晚云落（3点）：** 暴击率+30%，溢出按2:1转暴击效果（上限200%）
**被动-翩若惊鸿✅：** 
- 闪避成功：ATK+10，暴击率+5%（⚠️不加闪避率）
- 攻击暴击：闪避率+5%（上限50%）

### 澜
| 属性 | 生命700 | 攻击400 | 护甲250 | 暴击10% | 暴击效果130% |
|------|---------|---------|---------|---------|--------------|

**技能-鲨之猎刃（2点）：** 攻击力永久+100
**被动-狩猎✅：** 攻击血量<50%的敌人时，伤害+30%

### 孙尚香
| 属性 | 生命625 | 攻击550 | 护甲175 | 暴击15% | 暴击效果130% |
|------|---------|---------|---------|---------|--------------|

**技能-红莲爆弹（2点）：** 目标护甲-60，造成75真实伤害
**被动-千金重弩✅：** 普攻命中时70%概率+1技能点

### 朵莉亚
| 属性 | 生命900 | 攻击330 | 护甲325 | 暴击5% | 暴击效果130% |
|------|---------|---------|---------|--------|--------------|

**技能-人鱼之赐（1点）：** 治疗友方200生命
**被动-欢歌✅：** 回合开始时，自己+50HP，血量最低队友+50HP

### 少司缘
| 属性 | 生命750 | 攻击350 | 护甲225 | 暴击10% | 暴击效果130% |
|------|---------|---------|---------|---------|--------------|

**技能-两同心（2点）✅：** 友方治疗(100+偷取点×40)，敌方真伤(150+偷取点×50)可暴击
**被动-怨离别❌未实现**

### 杨玉环
| 属性 | 生命700 | 攻击400 | 护甲150 | 暴击15% | 暴击效果130% |
|------|---------|---------|---------|---------|--------------|

**技能-惊鸿曲（2点）✅：** 
- 血量≥50%：AOE伤害(0.3×ATK+0.2×已损)，可暴击
- 血量<50%：AOE治疗(0.3×ATK+0.2×当前HP)

**被动-霓裳风华❌未实现**

---

## 第五章：装备系统

### 5.1 基础装备（7种）
| 装备 | 效果 |
|------|------|
| 铁剑 | 攻击力+20 |
| 搏击拳套 | 暴击率+10% |
| 雷鸣刃 | 暴击效果+5% |
| 匕首 | 增伤+3% |
| 红玛瑙 | 最大生命+200 |
| 布甲 | 护甲+30 |
| 提神水晶 | 每回合恢复+30 |

### 5.2 进阶装备合成配方（9种）
| 材料 | 成品 | 效果 |
|------|------|------|
| 铁剑×2 | 风暴巨剑 | 攻击力+50 |
| 搏击拳套+匕首 | 穿云弓 | 暴击率+15%，增伤+5% |
| 铁剑+匕首 | 速击之枪 | 攻击力+25，增伤+7% |
| 搏击拳套+雷鸣刃 | 狂暴双刃 | 暴击率+13%，暴击效果+10% |
| 红玛瑙+铁剑 | 日冕 | 攻击力+25，最大生命+250 |
| 红玛瑙×2 | 力量腰带 | 最大生命+500 |
| 铁剑+布甲 | 荆棘护手 | 攻击力+25，护甲+40 |
| 红玛瑙+布甲 | 守护者之铠 | 最大生命+300，护甲+40 |
| 提神水晶+红玛瑙 | 熔炼之心 | 每回合+50，最大生命+400 |

### 5.3 装备规则
- 每英雄最多**2件**装备
- 购买：15金币抽3选1
- 合成：10金币，材料顺序无关
- 购买/装备/合成**不消耗行动点**

---

## 第六章：英雄选择

### 6.1 选人顺序（1-2-2-1）
| 轮次 | 蓝方 | 红方 |
|------|------|------|
| 1 | 选1个 | - |
| 2 | - | 选2个 |
| 3 | 选2个 | - |
| 4 | - | 选1个 |

### 6.2 可选英雄池
朵莉亚、澜、公孙离、孙尚香、瑶、大乔、少司缘、杨玉环（共8位）

---

## 第七章：回合流程

### 7.1 回合开始时（按顺序）
1. 技能点+1（第3回合起，给当前行动方）
2. 行动点重置为3（当前行动方）
3. 金币收入（当前行动方）
4. 朵莉亚被动"欢歌"触发
5. 装备"提神水晶/熔炼之心"回血

### 7.2 行动阶段操作
| 操作 | 行动点 | 技能点 | 金币 |
|------|--------|--------|------|
| 普通攻击 | -1 | - | - |
| 释放技能 | -1 | -N | - |
| 购买装备 | - | - | -15 |
| 装备物品 | - | - | - |
| 合成装备 | - | - | -10 |

### 7.3 结束回合
- 行动点用尽或主动结束
- 切换到对方回合

---

## 第八章：被动技能实现状态

| 英雄 | 被动 | 状态 | 触发时机 |
|------|------|------|----------|
| 瑶 | 山鬼白鹿 | ✅ | 受伤时 |
| 大乔 | 宿命之海 | ✅ | 致命伤害时 |
| 公孙离 | 翩若惊鸿 | ✅ | 闪避/暴击时 |
| 澜 | 狩猎 | ✅ | 攻击低血敌人 |
| 孙尚香 | 千金重弩 | ✅ | 普攻命中时 |
| 朵莉亚 | 欢歌 | ✅ | 回合开始时 |
| 少司缘 | 怨离别 | ❌ | 未实现 |
| 杨玉环 | 霓裳风华 | ❌ | 未实现 |

---

## 第九章：实战模拟

### 模拟设定
**蓝方（房主）：** 瑶、大乔、公孙离
**红方（客户端）：** 澜、孙尚香、朵莉亚

---

### 第1回合（蓝方行动）

**回合开始状态：**
```
技能点: 蓝方4/6 | 红方4/6
金币: 蓝方10 | 红方10
行动点: 蓝方3/3
```
⚠️ 第1回合蓝方无收入（游戏刚开始），技能点第3回合起才增加

**蓝方操作1：公孙离攻击澜**
```
公孙离ATK:575 → 澜护甲:250
基础伤害 = 575 × (200/450) = 575 × 0.444 = 255
暴击判定(20%)：假设未暴击
最终伤害: 255
澜HP: 700 → 445
```
行动点: 3→2

**蓝方操作2：瑶对公孙离释放「鹿灵守心」**
```
消耗2技能点(4→2)
护盾 = 170 + 850×10% = 170 + 85 = 255
公孙离获得: 护盾255, 暴击率+8%(20%→28%), 护甲+25(150→175)
```
行动点: 2→1

**蓝方操作3：大乔攻击澜**
```
大乔ATK:300 → 澜护甲:250
基础伤害 = 300 × (200/450) = 133
暴击判定(10%)：假设未暴击
最终伤害: 133
澜HP: 445 → 312
```
行动点: 1→0，**自动结束回合**

---

### 第2回合（红方行动）

**回合开始触发：**
```
① 行动点重置: 红方 0→3
② 金币收入: 红方 10 + 5 + 1(利息) = 16金币
③ 朵莉亚被动「欢歌」触发！
   - 朵莉亚自己: 900/900 → 已满血，溢出50转护盾
   - 朵莉亚护盾: 0 → 50
   - 血量最低队友(澜312HP): 312 → 362
```
⚠️ 技能点第3回合才开始增加，第2回合红方不获得技能点

**红方状态：**
```
技能点: 红方4/6
金币: 红方16
行动点: 红方3/3
澜HP: 362/700 | 孙尚香HP: 625/625 | 朵莉亚HP: 900/900 护盾50
```

**红方操作1：澜对公孙离攻击**
```
澜ATK:400 → 公孙离护甲:175(被瑶加了25)
基础伤害 = 400 × (200/375) = 400 × 0.533 = 213
公孙离血量600/600 = 100% > 50%，澜被动「狩猎」不触发
暴击判定(10%)：假设未暴击

闪避判定(25%)：假设闪避成功！
实际伤害: 0
公孙离被动触发: ATK+10(575→585), 暴击率+5%(28%→33%)
公孙离护盾255不变，HP600不变
```
行动点: 3→2

**红方操作2：孙尚香对公孙离攻击**
```
孙尚香ATK:550 → 公孙离护甲:175
基础伤害 = 550 × (200/375) = 293
闪避判定(25%)：假设未闪避
暴击判定(15%)：假设暴击！
暴击伤害 = 293 × 1.3 = 381

护盾吸收: 255
剩余伤害: 381 - 255 = 126
公孙离护盾: 255 → 0
公孙离HP: 600 → 474

孙尚香被动「千金重弩」判定(70%)：假设触发！
红方技能点: 4 → 5
```
行动点: 2→1

**红方操作3：澜释放「鲨之猎刃」**
```
消耗2技能点(5→3)
澜ATK: 400 → 500 (永久+100)
```
行动点: 1→0，**自动结束回合**

---

### 第3回合（蓝方行动）

**回合开始触发：**
```
① 行动点重置: 蓝方 0→3
② 技能点+1: 蓝方 2 → 3 (第3回合起开始增加)
③ 金币收入: 蓝方 10 + 5 + 1 = 16金币
④ 蓝方无朵莉亚，欢歌不触发
```

**蓝方状态：**
```
技能点: 蓝方3/6
金币: 蓝方16
行动点: 蓝方3/3
瑶HP: 850/850 | 大乔HP: 800/800 | 公孙离HP: 474/600
```

**蓝方操作1：公孙离攻击澜**
```
公孙离ATK:585 → 澜护甲:250
基础伤害 = 585 × (200/450) = 260
暴击判定(33%)：假设暴击！
暴击伤害 = 260 × 1.3 = 338

公孙离被动: 攻击暴击，闪避率+5%(25%→30%)
澜HP: 362 → 24
```
行动点: 3→2

**蓝方操作2：大乔攻击澜（致命一击）**
```
大乔ATK:300 → 澜护甲:250
基础伤害 = 300 × (200/450) = 133
暴击判定(10%)：假设未暴击
最终伤害: 133

澜HP: 24 → 0 ☠️ 澜阵亡！

💰 蓝方获得击杀奖励: 16 + 20 = 36金币
```
行动点: 2→1

**蓝方操作3：购买装备**
```
消耗15金币(36→21)，不消耗行动点
抽取3件: [铁剑, 红玛瑙, 匕首]
选择「铁剑」装备给公孙离
公孙离ATK: 585 → 605
```

**蓝方结束回合**

---

### 第4回合（红方行动）

**回合开始触发：**
```
① 行动点重置: 红方 0→3
② 技能点+1: 红方 3 → 4
③ 金币收入: 红方 16 + 5 + 1(利息) = 22金币
④ 朵莉亚被动「欢歌」触发！
   - 朵莉亚自己: 900/900 → 已满血，溢出50转护盾
   - 朵莉亚护盾: 50 → 100
   - 血量最低队友(孙尚香625HP): 625/625 → 已满血，不变
```

**红方状态：**
```
技能点: 红方4/6
金币: 红方22
存活: 孙尚香625/625 | 朵莉亚900/900护盾100
已阵亡: 澜
```

**红方操作1：孙尚香对公孙离释放「红莲爆弹」**
```
消耗2技能点(4→2)
公孙离护甲: 175 - 60 = 115
真实伤害75（穿透护盾，直接扣血）
公孙离HP: 474 → 399
```
行动点: 3→2

**红方操作2：孙尚香攻击公孙离**
```
孙尚香ATK:550 → 公孙离护甲:115
基础伤害 = 550 × (200/315) = 349
闪避判定(30%)：假设未闪避
暴击判定(15%)：假设未暴击
最终伤害: 349

公孙离HP: 399 → 50

孙尚香被动判定(70%)：假设触发！
红方技能点: 2 → 3
```
行动点: 2→1

**红方操作3：孙尚香攻击公孙离（致命一击）**
```
孙尚香ATK:550 → 公孙离护甲:115
基础伤害 = 550 × (200/315) = 349
闪避判定(30%)：假设闪避成功！

公孙离被动触发: ATK+10(605→615), 暴击率+5%(33%→38%)
伤害: 0
公孙离存活！HP: 50/600
```
行动点: 1→0，**自动结束回合**

---

### 关键机制总结

| 回合 | 触发顺序 |
|------|----------|
| 回合开始 | ①技能点+1(≥第3回合) → ②行动点重置 → ③金币收入 → ④朵莉亚欢歌 → ⑤装备回血 |
| 攻击时 | ①护甲减伤 → ②澜被动(攻击方为澜) → ③装备增伤 → ④暴击判定 → ⑤闪避判定 → ⑥护盾吸收 → ⑦扣血 |
| 攻击后 | ①孙尚香被动(命中时) → ②公孙离被动(闪避/暴击时) → ③瑶被动(受伤时) → ④大乔被动(致命时) |

---

## 第十章：待实现功能

1. **少司缘被动-怨离别：** 回合切换窃取技能点
2. **杨玉环被动-霓裳风华：** 技能后普攻增伤
3. **断线重连机制**
4. **观战系统**
5. **更多装备等级（史诗、传说）**

---

**版本：基于代码实现验证 | 更新时间：2025年**
